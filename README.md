# Telegram –ë–æ—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π Telegram-–±–æ—Ç –Ω–∞ **aiogram 3**, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≥–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç –∏—Ö —á–µ—Ä–µ–∑ Whisper, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —á–µ—Ä–µ–∑ LLM –∏ —Å–æ–∑–¥–∞—ë—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏, –∑–∞–¥–∞—á–∏ –∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è.

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üé§ –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π, –∞—É–¥–∏–æ –∏ –≤–∏–¥–µ–æ-–∫—Ä—É–∂–∫–æ–≤ —á–µ—Ä–µ–∑ Whisper (–ª–æ–∫–∞–ª—å–Ω–æ)
- ü§ñ –û–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ LLM —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º fallback (OpenRouter ‚Üí –ª–æ–∫–∞–ª—å–Ω–∞—è Ollama)
- üìù –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π (10 —Ç–∏–ø–æ–≤: —Å–æ–±—Ä–∞–Ω–∏—è, –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è, –∞—Ä—Ö–∏–≤, –¥–Ω–µ–≤–Ω–∏–∫, —Ä–∞–±–æ—Ç–∞, –¥–æ–º, —É—á—ë–±–∞, –∏–¥–µ–∏, –∑–¥–æ—Ä–æ–≤—å–µ, —Ñ–∏–Ω–∞–Ω—Å—ã)
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∑–∞–¥–∞—á –∏–∑ —Å–æ–±—Ä–∞–Ω–∏–π
- ‚è∞ –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
- üìö –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –∑–∞–º–µ—Ç–æ–∫
- üìã –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- üåê –í—ã–±–æ—Ä —è–∑—ã–∫–∞ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ (15 —è–∑—ã–∫–æ–≤ + –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ)
- üîÑ –û—á–µ—Ä–µ–¥—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–¥–∞—á
- üìä –ü—Ä–æ–≥—Ä–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- üìÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –±–æ–ª—å—à–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤ –∫–∞–∫ —Ñ–∞–π–ª–æ–≤

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Python 3.10+** - –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫
- **aiogram 3.x** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è Telegram –±–æ—Ç–æ–≤
- **faster-whisper** - –±—ã—Å—Ç—Ä–∞—è –ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –∞—É–¥–∏–æ (CTranslate2)
- **SQLModel** - ORM –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î (SQLAlchemy + Pydantic)
- **SQLite** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ Appwrite)
- **httpx** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ HTTP –∑–∞–ø—Ä–æ—Å—ã –∫ LLM API
- **loguru** - –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **pydantic-settings** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

## üìÅ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

```
bot_hnushka/
‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îú‚îÄ‚îÄ handlers/              # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ Telegram —Å–æ–±—ã—Ç–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ common.py          # –ö–æ–º–∞–Ω–¥—ã: /start, /menu, callback handlers
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ media.py           # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö/–∞—É–¥–∏–æ/–≤–∏–¥–µ–æ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ media_results.py   # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ models/                # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (SQLModel)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ database.py        # User, ProcessingTask, Meeting, Reminder, Archive, –∏ –¥—Ä.
‚îÇ   ‚îú‚îÄ‚îÄ services/              # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ whisper_service.py # –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –∞—É–¥–∏–æ —á–µ—Ä–µ–∑ faster-whisper
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ llm_service.py     # –†–∞–±–æ—Ç–∞ —Å LLM (OpenRouter/Ollama)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ queue_service.py   # –û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á –æ–±—Ä–∞–±–æ—Ç–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ storage/               # –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.py        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è SQLite, —Å–µ—Å—Å–∏–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ appwrite_storage.py # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Appwrite (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îÇ   ‚îî‚îÄ‚îÄ utils/                 # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ       ‚îú‚îÄ‚îÄ logger.py          # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ loguru
‚îÇ       ‚îî‚îÄ‚îÄ languages.py       # –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —è–∑—ã–∫–∏ –¥–ª—è Whisper
‚îú‚îÄ‚îÄ .codex/                    # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Codex CLI
‚îÇ   ‚îú‚îÄ‚îÄ run_codex.sh           # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ—É–ª—É—á—à–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ continuous_improvement.sh # –°–∏—Å—Ç–µ–º–∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ rules.md               # –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è Codex
‚îÇ   ‚îú‚îÄ‚îÄ memory.md              # –ò—Å—Ç–æ—Ä–∏—è —É–ª—É—á—à–µ–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ test_log.txt           # –õ–æ–≥–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ config.py                  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (Pydantic Settings)
‚îú‚îÄ‚îÄ main.py                    # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
‚îú‚îÄ‚îÄ requirements.txt           # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env                       # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–Ω–µ –≤ git)
‚îú‚îÄ‚îÄ env.example                # –ü—Ä–∏–º–µ—Ä .env —Ñ–∞–π–ª–∞
‚îú‚îÄ‚îÄ bot.db                     # SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–Ω–µ –≤ git)
‚îú‚îÄ‚îÄ bot.log                    # –õ–æ–≥–∏ –±–æ—Ç–∞
‚îî‚îÄ‚îÄ README.md                  # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

### –ü–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≥–æ–ª–æ—Å–æ–≤–æ–µ/–∞—É–¥–∏–æ/–≤–∏–¥–µ–æ
   ‚Üì
2. bot/handlers/media.py ‚Üí handle_media()
   - –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –Ω–∞ –¥–∏—Å–∫ (/tmp/bot_hnushka/)
   - –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –≤ –æ—á–µ—Ä–µ–¥–∏ (ProcessingTask)
   ‚Üì
3. bot/services/whisper_service.py ‚Üí transcribe()
   - –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ Whisper (medium –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
   - –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º (0-100%)
   - –í–æ–∑–≤—Ä–∞—Ç —Ç–µ–∫—Å—Ç–∞
   ‚Üì
4. bot/services/llm_service.py ‚Üí classify_message()
   - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Å–æ–æ–±—â–µ–Ω–∏—è (meeting/reminder/archive/diary/work/home/study/ideas/health/finance)
   ‚Üì
5. bot/services/llm_service.py ‚Üí process_*()
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
   ‚Üì
6. bot/handlers/media_results.py ‚Üí _send_*_result()
   - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
   - –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–æ–º –∏–ª–∏ —Ñ–∞–π–ª–æ–º (–µ—Å–ª–∏ >4096 —Å–∏–º–≤–æ–ª–æ–≤)
   - –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å, –∏–∑–º–µ–Ω–∏—Ç—å —Ç–∏–ø, —É–¥–∞–ª–∏—Ç—å)
```

### LLM Fallback Chain

```
1. OpenRouter (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
   - API: https://openrouter.ai/api/v1/chat/completions
   - –ú–æ–¥–µ–ª—å: google/gemini-2.0-flash-exp:free (–±–µ—Å–ø–ª–∞—Ç–Ω–∞—è)
   - –õ–∏–º–∏—Ç—ã: 20 req/min, 200 req/day
   ‚Üì (–µ—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)
2. Ollama (–ª–æ–∫–∞–ª—å–Ω—ã–π fallback)
   - API: http://localhost:11434/api/chat
   - –ú–æ–¥–µ–ª—å: qwen:4b (Qwen 2.5 4B)
   - –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
```

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
cd /root/bot_hnushka
python3 -m venv venv
source venv/bin/activate  # Linux/Mac
# –∏–ª–∏
venv\Scripts\activate  # Windows
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`:

```bash
cp .env.example .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```env
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ
BOT_TOKEN=your_telegram_bot_token_here

# Whisper (–ª–æ–∫–∞–ª—å–Ω—ã–π)
WHISPER_MODEL=medium
WHISPER_DEVICE=cpu

# OpenRouter (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π LLM)
OPENROUTER_API_KEY=your_openrouter_api_key_here
OPENROUTER_MODEL=google/gemini-2.0-flash-exp:free

# –õ–æ–∫–∞–ª—å–Ω–∞—è LLM (fallback)
LOCAL_LLM_URL=http://localhost:11434
LOCAL_LLM_MODEL=qwen:4b
LOCAL_LLM_API_TYPE=ollama

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
USE_APPWRITE=false
DATABASE_URL=sqlite+aiosqlite:///./bot.db
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤

### OpenRouter (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è - –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏!)

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ [OpenRouter.ai](https://openrouter.ai)
2. –ü–æ–ª—É—á–∏—Ç–µ API –∫–ª—é—á (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ!)
3. –£–∫–∞–∂–∏—Ç–µ –µ–≥–æ –≤ `.env` –∫–∞–∫ `OPENROUTER_API_KEY`
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–µ—Å–ø–ª–∞—Ç–Ω—É—é –º–æ–¥–µ–ª—å –≤ `.env`:
   ```env
   OPENROUTER_MODEL=google/gemini-2.0-flash-exp:free
   ```

**üöÄ –õ—É—á—à–∏–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏ OpenRouter:**

1. **`google/gemini-2.0-flash-exp:free`** ‚≠ê (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
   - –û—á–µ–Ω—å –±—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–ª–∏–∫
   - –ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–π (—Ç–µ–∫—Å—Ç, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –≤–∏–¥–µ–æ)
   - –û–≥—Ä–æ–º–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–æ ~1M —Ç–æ–∫–µ–Ω–æ–≤
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ—É–Ω–∫—Ü–∏–π –∏ –∫–æ–¥–∞
   - **1.5 –º–ª—Ä–¥ –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤!**

2. **`meta-llama/llama-3.3-70b-instruct:free`**
   - –ú–æ—â–Ω—ã–π 70B –¥–∏–∞–ª–æ–≥–æ–≤—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç
   - –ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã–π (8 —è–∑—ã–∫–æ–≤)
   - **2.6 –º–ª—Ä–¥ –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤!**

3. **`qwen/qwen-2.5-vl-7b-instruct:free`**
   - –ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–∞—è Qwen –º–æ–¥–µ–ª—å
   - –°–∏–ª—å–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –≤–∏–¥–µ–æ
   - **47 –º–ª–Ω –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤**

**–õ–∏–º–∏—Ç—ã –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π:**
- 20 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
- 200 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å
- –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏: –æ—à–∏–±–∫–∞ 429 Rate limit exceeded

### –õ–æ–∫–∞–ª—å–Ω–∞—è LLM (Ollama) - Fallback

**Ollama —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω!** –ú–æ–¥–µ–ª—å Qwen 2.5 4B —Å–∫–∞—á–∞–Ω–∞.

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ Ollama:**
   ```bash
   systemctl status ollama
   # –∏–ª–∏
   ollama list
   ```

2. **–ï—Å–ª–∏ Ollama –Ω–µ –∑–∞–ø—É—â–µ–Ω:**
   ```bash
   systemctl start ollama
   # –∏–ª–∏
   ollama serve
   ```

3. **–î–æ—Å—Ç—É–ø–Ω—ã–µ –º–æ–¥–µ–ª–∏:**
   - `qwen:4b` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (Qwen 2.5 4B, –ª–µ–≥–∫–∞—è ~1GB)
   - `qwen2.5:7b` - –±–æ–ª–µ–µ –º–æ—â–Ω–∞—è –º–æ–¥–µ–ª—å (4.7GB)
   - –î—Ä—É–≥–∏–µ –º–æ–¥–µ–ª–∏: `ollama pull <model_name>`

4. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ `.env`:**
   ```env
   LOCAL_LLM_URL=http://localhost:11434
   LOCAL_LLM_MODEL=qwen:4b
   LOCAL_LLM_API_TYPE=ollama
   ```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** Ollama –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ fallback, –µ—Å–ª–∏ OpenRouter –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É –±–æ—Ç–∞ –¥–∞–∂–µ –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞.

## üéÆ –ó–∞–ø—É—Å–∫

### Polling —Ä–µ–∂–∏–º (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

```bash
source venv/bin/activate
python main.py
```

### Production —Ä–µ–∂–∏–º (—Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º)

```bash
source venv/bin/activate
nohup python main.py >> bot.log 2>&1 &
echo $! > .codex/bot.pid
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç
ps aux | grep "python.*main.py"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
tail -f bot.log

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å PID
cat .codex/bot.pid
```

## üìñ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
2. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram –∏ –Ω–∞–π–¥–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/start`
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/menu` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –º–µ–Ω—é
5. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —è–∑—ã–∫ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏" ‚Üí "üåê –Ø–∑—ã–∫ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏"
   - –í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫ –∏–∑ —Å–ø–∏—Å–∫–∞ (15 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —è–∑—ã–∫–æ–≤ + –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ)
   - –¢–µ–∫—É—â–∏–π —è–∑—ã–∫ –æ—Ç–º–µ—á–µ–Ω –≥–∞–ª–æ—á–∫–æ–π ‚úÖ
6. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∞—É–¥–∏–æ –∏–ª–∏ –≤–∏–¥–µ–æ-–∫—Ä—É–∂–æ–∫

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –†–∞—Å—à–∏—Ñ—Ä—É–µ—Ç –∞—É–¥–∏–æ –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —è–∑—ã–∫–µ (–∏–ª–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç —è–∑—ã–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- –û–ø—Ä–µ–¥–µ–ª–∏—Ç —Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è (—Å–æ–±—Ä–∞–Ω–∏–µ/–Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ/–∞—Ä—Ö–∏–≤/–¥–Ω–µ–≤–Ω–∏–∫/—Ä–∞–±–æ—Ç–∞/–¥–æ–º/—É—á—ë–±–∞/–∏–¥–µ–∏/–∑–¥–æ—Ä–æ–≤—å–µ/—Ñ–∏–Ω–∞–Ω—Å—ã)
- –û–±—Ä–∞–±–æ—Ç–∞–µ—Ç –∏ —Å–æ–∑–¥–∞—Å—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç –∫–Ω–æ–ø–∫–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —è–∑—ã–∫–∏

–ë–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç 15 —Å–∞–º—ã—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —è–∑—ã–∫–æ–≤:
- üá∑üá∫ –†—É—Å—Å–∫–∏–π
- üá¨üáß English
- üá®üá≥ ‰∏≠Êñá
- üá™üá∏ Espa√±ol
- üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©
- üáµüáπ Portugu√™s
- üáØüáµ Êó•Êú¨Ë™û
- üá©üá™ Deutsch
- üá´üá∑ Fran√ßais
- üá∞üá∑ ÌïúÍµ≠Ïñ¥
- üáÆüáπ Italiano
- üáπüá∑ T√ºrk√ße
- üáÆüá≥ ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä
- üáµüá± Polski
- üá≥üá± Nederlands

–¢–∞–∫–∂–µ –¥–æ—Å—Ç—É–ø–µ–Ω —Ä–µ–∂–∏–º "–ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ", –∫–æ–≥–¥–∞ –±–æ—Ç —Å–∞–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —è–∑—ã–∫ –∞—É–¥–∏–æ.

## üóÑ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### SQLite (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ —Ñ–∞–π–ª–µ `bot.db` –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ.

**–ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö:**
- `User` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ Telegram
- `ProcessingTask` - –∑–∞–¥–∞—á–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–æ—á–µ—Ä–µ–¥—å)
- `Meeting` - —Å–æ–±—Ä–∞–Ω–∏—è
- `Reminder` - –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
- `ArchiveItem` - –∞—Ä—Ö–∏–≤–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏
- `DiaryEntry` - –∑–∞–ø–∏—Å–∏ –¥–Ω–µ–≤–Ω–∏–∫–∞
- `WorkNote` - —Ä–∞–±–æ—á–∏–µ –∑–∞–º–µ—Ç–∫–∏
- `HomeTask` - –±—ã—Ç–æ–≤—ã–µ –∑–∞–¥–∞—á–∏
- `StudyNote` - —É—á–µ–±–Ω—ã–µ –∫–æ–Ω—Å–ø–µ–∫—Ç—ã
- `Idea` - –∏–¥–µ–∏
- `HealthLog` - –∑–∞–ø–∏—Å–∏ –æ –∑–¥–æ—Ä–æ–≤—å–µ
- `FinanceTransaction` - —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

### Appwrite (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

1. **–°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ Appwrite:**
   - –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ [Appwrite Cloud](https://cloud.appwrite.io) –∏–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ
   - –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
   - –ü–æ–ª—É—á–∏—Ç–µ `Project ID` –∏ `API Key`

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ `.env`:**
   ```env
   USE_APPWRITE=true
   APPWRITE_ENDPOINT=https://cloud.appwrite.io/v1
   APPWRITE_PROJECT_ID=your_project_id
   APPWRITE_API_KEY=your_api_key
   ```

3. **–°–æ–∑–¥–∞–π—Ç–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –≤ Appwrite** (—Å–º. `bot/storage/appwrite_storage.py`)

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞** - –æ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ Appwrite

## ü§ñ Codex CLI –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

–ü—Ä–æ–µ–∫—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å **Codex CLI** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è –∫–æ–¥–∞.

### –ß—Ç–æ —Ç–∞–∫–æ–µ Codex?

Codex CLI - —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –æ—Ç OpenAI –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ —É–ª—É—á—à–µ–Ω–∏—è –∫–æ–¥–∞. –û–Ω:
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–æ–¥ –Ω–∞ –æ—à–∏–±–∫–∏, –±–∞–≥–∏, –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –ö–æ–º–º–∏—Ç–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Git

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Codex

```
.codex/
‚îú‚îÄ‚îÄ run_codex.sh              # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ—É–ª—É—á—à–µ–Ω–∏—è
‚îú‚îÄ‚îÄ continuous_improvement.sh # –°–∏—Å—Ç–µ–º–∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è
‚îú‚îÄ‚îÄ rules.md                  # –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è Codex (—á—Ç–æ –∏—Å–ø—Ä–∞–≤–ª—è—Ç—å)
‚îú‚îÄ‚îÄ memory.md                 # –ò—Å—Ç–æ—Ä–∏—è —É–ª—É—á—à–µ–Ω–∏–π (—á—Ç–æ–±—ã –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—Ç—å—Å—è)
‚îî‚îÄ‚îÄ test_log.txt              # –õ–æ–≥–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```

### –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è Codex

Codex —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∞–≤–∏–ª–∞–º –∏–∑ `.codex/rules.md`:

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:**
- –†–∞–±–æ—Ç–∞—Ç—å –¢–û–õ–¨–ö–û –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `/root/bot_hnushka` –∏ –µ—ë –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö
- –ù–ò–ö–û–ì–î–ê –Ω–µ –º–µ–Ω—è—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∑–∞ –ø—Ä–µ–¥–µ–ª—ã `bot_hnushka`
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ñ–∞–π–ª–∞–º–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∫ –∫–æ—Ä–Ω—é –ø—Ä–æ–µ–∫—Ç–∞

**–ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª—è—Ç—å:**
- Race conditions –≤ async –∫–æ–¥–µ
- Memory leaks (–Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–µ —Ä–µ—Å—É—Ä—Å—ã)
- Unhandled exceptions
- Blocking I/O –≤ async —Ñ—É–Ω–∫—Ü–∏—è—Ö
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ type hints
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
- –ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ß—Ç–æ –ù–ï –º–µ–Ω—è—Ç—å:**
- –†–∞–±–æ—á—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–∞)
- API –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã (–µ—Å–ª–∏ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
- –°—Ö–µ–º—É –ë–î (–µ—Å–ª–∏ –Ω–µ –º–∏–≥—Ä–∞—Ü–∏—è)
- –í–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–µ—Å–ª–∏ –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)

### –ó–∞–ø—É—Å–∫ Codex –≤—Ä—É—á–Ω—É—é

```bash
cd /root/bot_hnushka
./.codex/run_codex.sh
```

### –°–∏—Å—Ç–µ–º–∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è:
- ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±–æ—Ç–∞ –≤ —Ä–∞–±–æ—á–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç runtime –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç Codex –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –æ—à–∏–±–æ–∫
- ‚úÖ –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —É–ª—É—á—à–∞–µ—Ç –∫–æ–¥ (–∫–∞–∂–¥—ã–π —á–∞—Å)
- ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –ø–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π

**–ó–∞–ø—É—Å–∫:**

```bash
cd /root/bot_hnushka
nohup bash .codex/continuous_improvement.sh > .codex/continuous.log 2>&1 &
```

**–õ–æ–≥–∏:**
- `bot.log` - –ª–æ–≥–∏ –±–æ—Ç–∞
- `.codex/errors.log` - –∏—Å—Ç–æ—Ä–∏—è –æ—à–∏–±–æ–∫
- `.codex/improvement.log` - –ª–æ–≥–∏ —É–ª—É—á—à–µ–Ω–∏–π Codex
- `.codex/continuous.log` - –ª–æ–≥–∏ continuous improvement

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–æ—Ç–∞: –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- –£–ª—É—á—à–µ–Ω–∏–µ –∫–æ–¥–∞: –∫–∞–∂–¥—ã–µ 60 –º–∏–Ω—É—Ç (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ —Å–∫—Ä–∏–ø—Ç–µ)

–ü–æ–¥—Ä–æ–±–Ω–µ–µ: [.codex/CONTINUOUS_IMPROVEMENT.md](.codex/CONTINUOUS_IMPROVEMENT.md)

### Git Hooks

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ Codex –ø–æ—Å–ª–µ –∫–æ–º–º–∏—Ç–æ–≤ –∏ –º–µ—Ä–∂–µ–π:

- `.git/hooks/post-commit` - –∑–∞–ø—É—Å–∫ Codex –ø–æ—Å–ª–µ –∫–æ–º–º–∏—Ç–∞
- `.git/hooks/post-merge` - –∑–∞–ø—É—Å–∫ Codex –ø–æ—Å–ª–µ merge/pull

–û–±–∞ —Ö—É–∫–∞ –∑–∞–ø—É—Å–∫–∞—é—Ç Codex –≤ —Ñ–æ–Ω–µ –≤ tmux —Å–µ—Å—Å–∏–∏ `hnushka`.

## üîç –î–µ—Ç–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ (handlers)

**bot/handlers/common.py:**
- `/start` - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
- `/menu` - –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- Callback handlers –¥–ª—è –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ –º–µ–Ω—é
- –í—ã–±–æ—Ä —è–∑—ã–∫–∞ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥–µ–ª–µ–π

**bot/handlers/media.py:**
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (`F.voice`)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞—É–¥–∏–æ (`F.audio`)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ-–∫—Ä—É–∂–∫–æ–≤ (`F.video_note`)
- –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –Ω–∞ –¥–∏—Å–∫
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –≤ –æ—á–µ—Ä–µ–¥–∏
- –í—ã–∑–æ–≤ Whisper –∏ LLM —Å–µ—Ä–≤–∏—Å–æ–≤

**bot/handlers/media_results.py:**
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–æ–º –∏–ª–∏ —Ñ–∞–π–ª–æ–º (–µ—Å–ª–∏ >4096 —Å–∏–º–≤–æ–ª–æ–≤)
- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º

### –°–µ—Ä–≤–∏—Å—ã (services)

**bot/services/whisper_service.py:**
- –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ Whisper (–æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏)
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑ `asyncio.to_thread()`
- –ü—Ä–æ–≥—Ä–µ—Å—Å —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ (callback)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—ã–±–æ—Ä–∞ —è–∑—ã–∫–∞

**bot/services/llm_service.py:**
- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π (`classify_message()`)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ —Ç–∏–ø–∞–º (`process_meeting()`, `process_reminder()`, –∏ –¥—Ä.)
- Fallback chain: OpenRouter ‚Üí Ollama
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ —Ç–∞–π–º–∞—É—Ç–æ–≤

**bot/services/queue_service.py:**
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥—å—é –∑–∞–¥–∞—á (`ProcessingTask`)
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞—á –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –°—Ç–∞—Ç—É—Å—ã: QUEUED, TRANSCRIBING, PROCESSING, DONE, ERROR

### –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (models)

**bot/models/database.py:**
- SQLModel –º–æ–¥–µ–ª–∏ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- –°–≤—è–∑–∏ –º–µ–∂–¥—É –º–æ–¥–µ–ª—è–º–∏ (relationships)
- Enum –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤ –∏ —Ç–∏–ø–æ–≤

### –•—Ä–∞–Ω–∏–ª–∏—â–µ (storage)

**bot/storage/database.py:**
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è SQLite –ë–î
- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏ (AsyncSessionLocal)

**bot/storage/appwrite_storage.py:**
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Appwrite (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π API (Appwrite SDK —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π)

## üé® –¢–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ 10 —Ç–∏–ø–æ–≤:

1. **–°–æ–±—Ä–∞–Ω–∏–µ (Meeting)** - –¥–∏–∞–ª–æ–≥ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ª—é–¥–µ–π, –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –∑–∞–¥–∞—á
2. **–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ (Reminder)** - –∫–æ—Ä–æ—Ç–∫–∞—è —Ñ—Ä–∞–∑–∞ —Å –±—É–¥—É—â–∏–º –¥–µ–π—Å—Ç–≤–∏–µ–º/–¥–∞—Ç–æ–π
3. **–ê—Ä—Ö–∏–≤ (Archive)** - –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω–∞—è —Ä–µ—á—å –æ —Ç–æ–º, —á—Ç–æ —Å–¥–µ–ª–∞–Ω–æ/–¥–µ–ª–∞–µ—Ç—Å—è
4. **–î–Ω–µ–≤–Ω–∏–∫ (Diary)** - –ø–æ—Ç–æ–∫ –º—ã—Å–ª–µ–π, –ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏–π, –ø–ª–∞–Ω–æ–≤
5. **–†–∞–±–æ—Ç–∞ (Work)** - –Ω–∞–±—Ä–æ—Å–∫–∏ –ø–æ –∑–∞–¥–∞—á–∞–º, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–¥–µ–∏, —Ä–µ—Ç—Ä–æ
6. **–î–æ–º (Home)** - –≥–æ–ª–æ—Å–æ–≤—ã–µ –ø—Ä–æ –¥–æ–º–∞—à–Ω–∏–µ –¥–µ–ª–∞, –ø–æ–∫—É–ø–∫–∏, —Ä–µ–º–æ–Ω—Ç
7. **–£—á—ë–±–∞ (Study)** - –∫–æ–Ω—Å–ø–µ–∫—Ç—ã —Å –ª–µ–∫—Ü–∏–π, –∫—É—Ä—Å–æ–≤, –∫–Ω–∏–≥
8. **–ò–¥–µ–∏ (Ideas)** - –ø–æ—Ç–æ–∫ –∏–¥–µ–π: —Å—Ç–∞—Ä—Ç–∞–ø—ã, —Ñ–∏—á–∏, —Å—Ü–µ–Ω–∞—Ä–∏–∏
9. **–ó–¥–æ—Ä–æ–≤—å–µ (Health)** - –∑–∞–º–µ—Ç–∫–∏ –æ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–∏, —Å–∏–º–ø—Ç–æ–º–∞—Ö, –¥–µ–π—Å—Ç–≤–∏—è—Ö
10. **–§–∏–Ω–∞–Ω—Å—ã (Finance)** - –Ω–∞–¥–∏–∫—Ç–æ–≤–∫–∞ —Ç—Ä–∞—Ç –∏ –¥–æ—Ö–æ–¥–æ–≤

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–¥–µ–ª–µ–π Whisper

–î–æ—Å—Ç—É–ø–Ω—ã–µ –º–æ–¥–µ–ª–∏ (–æ—Ç –º–µ–Ω—å—à–µ–π –∫ –±–æ–ª—å—à–µ–π):
- `tiny` - —Å–∞–º–∞—è –±—ã—Å—Ç—Ä–∞—è, –Ω–∞–∏–º–µ–Ω—å—à–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å
- `base` - –±–∞–ª–∞–Ω—Å —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏
- `small`
- `medium` - —Ö–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `large-v2` - —Å–∞–º–∞—è —Ç–æ—á–Ω–∞—è, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–∞—è

–î–ª—è GPU –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `WHISPER_DEVICE=cuda`.

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ–¥–µ–ª—å `medium` –¥–ª—è –ª—É—á—à–µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏. –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞, –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ `base` –∏–ª–∏ `small` –≤ `.env`.

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤:
- `bot.log` - –æ—Å–Ω–æ–≤–Ω—ã–µ –ª–æ–≥–∏ –±–æ—Ç–∞
- `logs/` - —Ä–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ –ø–æ –¥–Ω—è–º (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)

–£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `LOG_LEVEL` –≤ `.env`:
- `DEBUG` - –¥–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- `INFO` - –æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `WARNING` - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- `ERROR` - –æ—à–∏–±–∫–∏
- `CRITICAL` - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –í–∞–∂–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞

1. **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ Git:**
   - –í—Å–µ API –∫–ª—é—á–∏, —Ç–æ–∫–µ–Ω—ã, –ø–∞—Ä–æ–ª–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ `.env`
   - `.env` –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.gitignore`
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `env.example` –¥–ª—è –ø—Ä–∏–º–µ—Ä–æ–≤

2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:**
   - –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è
   - –ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä—É—é—Ç—Å—è
   - SQL –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ ORM (–∑–∞—â–∏—Ç–∞ –æ—Ç SQL injection)

3. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ª–æ–≥–∏—Ä—É–π—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
   - –í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º

–ü–æ–¥—Ä–æ–±–Ω–µ–µ: [SECURITY.md](SECURITY.md)

## üêõ Troubleshooting

### –û—à–∏–±–∫–∞ "LLM –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ OpenRouter –¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ Ollama –∑–∞–ø—É—â–µ–Ω
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `.env`
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ª–æ–∫–∞–ª—å–Ω–∞—è LLM (Ollama) –∑–∞–ø—É—â–µ–Ω–∞, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ fallback
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `tail -f bot.log | grep -i error`

### –û—à–∏–±–∫–∞ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –∞—É–¥–∏–æ

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –º–æ–¥–µ–ª—å Whisper –∑–∞–≥—Ä—É–∂–µ–Ω–∞ (–ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–ª–≥–∏–º)
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ
3. –î–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–¥–µ–ª—å `base` –∏–ª–∏ –º–µ–Ω—å—à–µ
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `tail -f bot.log | grep -i whisper`

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ë–î

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –∫ –ë–î –≤ `DATABASE_URL`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `tail -f bot.log | grep -i database`

### –ö–Ω–æ–ø–∫–∏ –º–µ–Ω—é –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ `main.py`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏: `tail -f bot.log | grep -i error`

### –ë–æ—Ç –¥–æ–ª–≥–æ –æ—Ç–≤–µ—á–∞–µ—Ç

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Whisper –º–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ (–ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫)
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ LLM –¥–æ—Å—Ç—É–ø–µ–Ω (OpenRouter –∏–ª–∏ Ollama)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä: `htop` –∏–ª–∏ `top`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ —Ç–∞–π–º–∞—É—Ç—ã: `tail -f bot.log | grep -i timeout`

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [FREE_MODELS.md](FREE_MODELS.md) - —Å–ø–∏—Å–æ–∫ –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π OpenRouter
- [STATUS.md](STATUS.md) - —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
- [SECURITY.md](SECURITY.md) - –ø—Ä–∞–∫—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- [GIT_SETUP.md](GIT_SETUP.md) - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Git –∏ GitHub
- [.codex/CONTINUOUS_IMPROVEMENT.md](.codex/CONTINUOUS_IMPROVEMENT.md) - —Å–∏—Å—Ç–µ–º–∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è

## üß™ –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∏ Codex

### –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è Codex

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:**
- –†–∞–±–æ—Ç–∞—Ç—å –¢–û–õ–¨–ö–û –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `/root/bot_hnushka` –∏ –µ—ë –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö
- –ù–ò–ö–û–ì–î–ê –Ω–µ –º–µ–Ω—è—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∑–∞ –ø—Ä–µ–¥–µ–ª—ã `bot_hnushka`
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ñ–∞–π–ª–∞–º–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∫ –∫–æ—Ä–Ω—é –ø—Ä–æ–µ–∫—Ç–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `venv` –¥–ª—è –≤—Å–µ—Ö Python –∫–æ–º–∞–Ω–¥

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**
- –í—Å–µ I/O –æ–ø–µ—Ä–∞—Ü–∏–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ (`async/await`)
- CPU-bound –æ–ø–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ `asyncio.to_thread()`
- –í—Å–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
- Type hints –≤–µ–∑–¥–µ
- –°–ª–µ–¥–æ–≤–∞—Ç—å PEP 8

**–í–∞–∂–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `main.py` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–æ—É—Ç–µ—Ä–æ–≤
- `config.py` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ Pydantic Settings
- `bot/handlers/` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ Telegram —Å–æ–±—ã—Ç–∏–π
- `bot/services/` - –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- `bot/models/` - –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
- `bot/storage/` - —Ä–∞–±–æ—Ç–∞ —Å –ë–î

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–ø–æ—Ä—Ç–æ–≤: `python -c "from config import settings"`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞: `python -m py_compile main.py`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: –∑–∞–ø—É—Å–∫ –±–æ—Ç–∞ —Å —Ç–∞–π–º–∞—É—Ç–æ–º
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ runtime –æ—à–∏–±–æ–∫ –≤ `bot.log`

**Codex –¥–æ–ª–∂–µ–Ω:**
1. –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –Ω–∞ –æ—à–∏–±–∫–∏ –∏ –ø—Ä–æ–±–ª–µ–º—ã
2. –ò—Å–ø—Ä–∞–≤–ª—è—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
4. –ö–æ–º–º–∏—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è (–µ—Å–ª–∏ –µ—Å—Ç—å)
5. –û–±–Ω–æ–≤–ª—è—Ç—å `.codex/memory.md` —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏

**Codex –ù–ï –¥–æ–ª–∂–µ–Ω:**
- –ú–µ–Ω—è—Ç—å —Ä–∞–±–æ—á—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –õ–æ–º–∞—Ç—å API –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- –ò–∑–º–µ–Ω—è—Ç—å —Å—Ö–µ–º—É –ë–î –±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏
- –£–¥–∞–ª—è—Ç—å –≤–∞–∂–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- –ú–µ–Ω—è—Ç—å –ª–æ–≥–∏–∫—É –±–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
cd /root/bot_hnushka
source venv/bin/activate
./.codex/test_and_debug.sh
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–ø–æ—Ä—Ç–æ–≤
python -c "from config import settings; from bot.handlers import common, media"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
python -m py_compile main.py bot/handlers/*.py bot/services/*.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω mypy)
mypy bot/ --ignore-missing-imports
```

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

## üë§ –ê–≤—Ç–æ—Ä

–°–æ–∑–¥–∞–Ω–æ —Å –ø–æ–º–æ—â—å—é Cursor AI –∏ Codex CLI

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2026-01-02  
**–í–µ—Ä—Å–∏—è:** 1.0.0
